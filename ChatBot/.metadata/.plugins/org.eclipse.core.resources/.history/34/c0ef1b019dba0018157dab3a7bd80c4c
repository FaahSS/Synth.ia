package dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import beans.Alternativa;
import bo.AlternativaBO;
import connection.Conexao;

/**
 * Esta classe manipula a tabela T_SIC_ALTERNATIVA
 * possui métodos para: Cadastrar, Consultar, Alterar e Excluir
 * @author Fábio Salgarella
 * @version 1.0
 * @since 1.0
 * @see AlternativaBO
 * @see AlternativaBeans
 */

public class AlternativaDAO {
	private Connection con;
	private PreparedStatement stmt;
	private ResultSet rs;
	
	/**
	 * Neste método construtor, estabelecemos a comunicação com o banco
	 * @author Fábio Salgarella
	 * @param Não possui parâmetros
	 * @eturn Não há retorno
	 * @throws Exception Chamada da exceção checked SQLException
	 */
	
	public AlternativaDAO() throws Exception {
		con = new Conexao().conectar();
	}
	
	/**
	 * Responsável por adicionar uma linha na tabela T_SIC_ALTERNATIVA
	 * @param alt Recebe um objeto do Tipo Alternativa Beans
	 * @return Uma string com a mensagem de confirmação.
	 * @throws Exception Chamada da exceção checked.
	 * @author Fábio Salgarella
	 */
	public String gravar(Alternativa alt) throws Exception{
		PreparedStatement stmt = con.prepareStatement("INSERT INTO T_SIC_ALTERNATIVA (CD_ALTERNATIVA, CD_QUESTAO, DS_ALTERNATIVA) VALUES (?,?,?)");
		
		stmt.setInt(1, alt.getCodigoAlternativa());
		stmt.setInt(2, alt.getCodigoQuestao().getCodigo());
		stmt.setString(3, alt.getDescricao());
		stmt.executeUpdate();
		
		return "Cadastrado com Sucesso!";
	}
	
	/**
	 * Responsável por consultar linhas na tabela T_SIC_ALTERNATIVA
	 * @param numero Recebe um objeto do Tipo Questao.
	 * @return Uma linha com as alternativas da questão.
	 * @throws Exception Chamada da exceção checked.
	 * @author Fábio Salgarella
	 */
	
	public Alternativa consultarPorQuestao(int numero) throws Exception{
		stmt = con.prepareStatement("SELECT * FROM T_SIC_ALTERNATIVA ON(CD_ALTERNATIVA, DS_ALTERNATIVA) WHERE CD_QUESTAO=?");
		stmt.setInt(1, numero);
		rs= stmt.executeQuery();
		
		if(rs.next()) {
			return new Alternativa (rs.getInt("CD_ALTERNATIVA"),
				   rs.getInt.("CD_QUESTAO"),
				   rs.getString("DS_ALTERNATIVA"))
									;
		}else {
			return new Alternativa();
		}
	}
	

}
